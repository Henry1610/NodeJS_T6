<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern, html5, responsive">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Dreams POS Admin Template</title>

    <link rel="shortcut icon" type="image/x-icon" href="/template/img/favicon.jpg">
    <link rel="stylesheet" href="/template/css/bootstrap.min.css">
    <link rel="stylesheet" href="/template/css/animate.css">
    <link rel="stylesheet" href="/template/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="/template/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/template/plugins/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="/template/css/style.css">
</head>

<body>
    <div id="global-loader">
        <div class="whirly-loader"></div>
    </div>

    <div class="main-wrapper">
        <%- include('../../components/header.ejs') %>
        <%- include('../../components/sidebar.ejs') %>

        <div class="page-wrapper">
            <div class="content">
                <div class="page-header">
                    <div class="page-title">
                        <h4>Product Statistics</h4>
                        <h6>View product reports</h6>
                    </div>
                    <div class="page-btn">
                        <a href="/admin/productlist" class="btn btn-added">
                            <i class="fa fa-arrow-left"></i>
                        </a>
                    </div>
                </div>

                <!-- Overview Section -->
                <div class="row">
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="dash-widget">
                            <div class="dash-widgetimg">
                                <span><img src="/template/img/icons/dash1.svg" alt="Total Products"></span>
                            </div>
                            <div class="dash-widgetcontent">
                                <h5><span class="counters"><%= totalProducts %></span></h5>
                                <h6>Total Products</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="dash-widget dash2">
                            <div class="dash-widgetimg">
                                <span><img src="/template/img/icons/dash2.svg" alt="Inventory Value"></span>
                            </div>
                            <div class="dash-widgetcontent">
                                <h5><span class="counters"><%= totalInventoryValue.toLocaleString() %></span></h5>
                                <h6>Total Inventory Value</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="dash-widget dash3">
                            <div class="dash-widgetimg">
                                <span><img src="/template/img/icons/dash3.svg" alt="Categories"></span>
                            </div>
                            <div class="dash-widgetcontent">
                                <h5><span class="counters"><%= Object.keys(productsByCategory).length %></span></h5>
                                <h6>Total Categories</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6 col-12">
                        <div class="dash-widget dash4">
                            <div class="dash-widgetimg">
                                <span><img src="/template/img/icons/dash4.svg" alt="Brands"></span>
                            </div>
                            <div class="dash-widgetcontent">
                                <h5><span class="counters"><%= Object.keys(productsByBrand).length %></span></h5>
                                <h6>Total Brands</h6>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top 5 Most Expensive Products -->
                <div class="row">
                    <div class="col-lg-6 col-sm-12">
                        <div class="card">
                            <div class="card-header">
                                <h4>Top 5 Most Expensive Products</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table datanew">
                                        <thead>
                                            <tr>
                                                <th>Product Name</th>
                                                <th>Category</th>
                                                <th>Price</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% topExpensiveProducts.forEach(function(product) { %>
                                                <tr>
                                                    <td><%= product.title %></td>
                                                    <td><%= product.categoryName || 'N/A' %></td>
                                                    <td><%= product.price.toLocaleString() %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Top 5 Products by Quantity -->
                    <div class="col-lg-6 col-sm-12">
                        <div class="card">
                            <div class="card-header">
                                <h4>Top 5 Products by Quantity</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table datanew">
                                        <thead>
                                            <tr>
                                                <th>Product Name</th>
                                                <th>Brand</th>
                                                <th>Quantity</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% topQuantityProducts.forEach(function(product) { %>
                                                <tr>
                                                    <td><%= product.title %></td>
                                                    <td><%= product.brandName || 'N/A' %></td>
                                                    <td><%= product.quantity %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Inventory Value by Category -->
                <div class="row">
                    <div class="col-lg-12 col-sm-12">
                        <div class="card">
                            <div class="card-header">
                                <h4>Inventory Value by Category</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table datanew">
                                        <thead>
                                            <tr>
                                                <th>Category</th>
                                                <th>Product Count</th>
                                                <th>Total Value</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% Object.keys(productsByCategory).forEach(function(category) { %>
                                                <tr>
                                                    <td><%= category %></td>
                                                    <td><%= productsByCategory[category].length %></td>
                                                    <td><%= totalInventoryValue.toLocaleString() %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/template/js/jquery-3.6.0.min.js"></script>
    <script src="/template/js/feather.min.js"></script>
    <script src="/template/js/jquery.slimscroll.min.js"></script>
    <script src="/template/js/jquery.dataTables.min.js"></script>
    <script src="/template/js/dataTables.bootstrap4.min.js"></script>
    <script src="/template/js/bootstrap.bundle.min.js"></script>
    <script src="/template/plugins/apexchart/apexcharts.min.js"></script>
    <script src="/template/plugins/apexchart/chart-data.js"></script>
    <script src="/template/js/script.js"></script>
</body>
</html>